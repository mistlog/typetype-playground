{"code":"/**\r\n * test it in typescript playgorund:\r\n * \r\n * type url = `http://admin:123456@github.com:8080`;\r\n * type result = parseURL<url>\r\n */\r\nexport type function parseURL = (text) => ^{\r\n    if (parseProtocol<text> extends [infer protocol, infer rest]) {\r\n        return {\r\n            protocol,\r\n            ...parseAuthority<rest>\r\n        }\r\n    } else {\r\n        return never\r\n    }\r\n}\r\n\r\ntype function parseProtocol = (text) => ^{\r\n    if(text extends `${infer protocol}://${infer rest}`) {\r\n        return [\r\n            protocol,\r\n            rest\r\n        ]\r\n    } else {\r\n        return never\r\n    }\r\n}\r\n\r\ntype function parseUserInfo = (text) => ^{\r\n    if(text extends `${infer username}:${infer password}`) {\r\n        return { username, password }\r\n    } else {\r\n        return { username: text }\r\n    }\r\n}\r\n\r\ntype function parseAuthority = (text) => ^{\r\n    if(text extends `${infer authority}@${infer rest}`) {\r\n        return {\r\n            authority: parseUserInfo<authority>,\r\n            ...parseHost<rest>\r\n        }\r\n    } else { \r\n        return {\r\n            authority: null,\r\n            rest: text\r\n        }\r\n    }\r\n}\r\n\r\ntype function parseHost = (text) => ^{\r\n    if(text extends `${infer name}:${infer port}`) {\r\n        return ^{\r\n            if(parsePort<port> extends never) {\r\n                return never\r\n            } else {\r\n                return { name, port }\r\n            }\r\n        }\r\n    } else {\r\n        return { name: text }\r\n    }\r\n}\r\n\r\ntype function parsePort = (text) => ^{\r\n    if(isNumberString<text> extends true) {\r\n        return text\r\n    } else {\r\n        return never\r\n    }\r\n}\r\n\r\ntype function isNumberString = (text) => ^{\r\n    if(text extends \"\") {\r\n        return never\r\n    } else {\r\n        return _isNumberString<text>\r\n    }\r\n}\r\n\r\ntype function _isNumberString = (text) => ^{\r\n    /* the end of recursion: each char of text is digit, no more chars to inspect */\r\n    if(text extends \"\") {\r\n        return true\r\n    } else if(text extends `${infer digit}${infer rest}`) {\r\n        return ^{\r\n            if(digit extends Digit) {\r\n                return _isNumberString<rest>\r\n            } else {\r\n                return false\r\n            }\r\n        }\r\n    } else {\r\n        return false\r\n    }\r\n}\r\n\r\ntype Digit = union [\"0\" , \"1\" , \"2\" , \"3\" , \"4\" , \"5\" , \"6\" , \"7\" , \"8\" , \"9\"]"}